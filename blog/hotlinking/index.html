<!doctype html>
<html lang="ru" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Хотлинкинг и как от него защититься | Alex Congritta</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://congritta.ru/blog/hotlinking"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Хотлинкинг и как от него защититься | Alex Congritta"><meta data-rh="true" name="description" content="Наверное многим держателям онлайн-ресурсов знакома проблема, когда сторонние сайты воруют ссылки на скачивание"><meta data-rh="true" property="og:description" content="Наверное многим держателям онлайн-ресурсов знакома проблема, когда сторонние сайты воруют ссылки на скачивание"><meta data-rh="true" property="og:image" content="https://congritta.ru/assets/images/poster-d847855429228b60240e2b3a42773bab.jpg"><meta data-rh="true" name="twitter:image" content="https://congritta.ru/assets/images/poster-d847855429228b60240e2b3a42773bab.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-11-10T18:00:00.000Z"><meta data-rh="true" property="article:author" content="https://congritta.com"><meta data-rh="true" property="article:tag" content="информационная безопасность,infosec"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://congritta.ru/blog/hotlinking"><link data-rh="true" rel="alternate" href="https://congritta.ru/blog/hotlinking" hreflang="ru"><link data-rh="true" rel="alternate" href="https://congritta.ru/blog/hotlinking" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alex Congritta RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alex Congritta Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e508ab34.css">
<link rel="preload" href="/assets/js/runtime~main.6180334c.js" as="script">
<link rel="preload" href="/assets/js/main.a9a73014.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Alex Congritta Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Alex Congritta Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Alex Congritta</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Блог</a><a class="navbar__item navbar__link" href="/blog/tags/пет-проекты">Пет-проекты</a><a class="navbar__item navbar__link" href="/faq">FAQ</a><a href="https://hoolie.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Hoolie Projects</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/congritta" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://t.me/congrittaBlog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.youtube.com/@congritta" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Навигация по последним постам в блоге"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hoolie-blog">Hoolie Blog</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/about-a-god">Мои мысли о религии</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hoc">Crypto Timeline</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/my-password">Первый пет-проект в 2024 году - My Password</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/linux-is-not-secure">Linux не безопаснее Windows</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://congritta.ru/assets/images/poster-d847855429228b60240e2b3a42773bab.jpg"><header><h1 class="title_f1Hy" itemprop="headline">Хотлинкинг и как от него защититься</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-11-10T18:00:00.000Z" itemprop="datePublished">10 ноября 2023 г.</time> · <!-- -->4 мин. чтения</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://congritta.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/congritta.png" alt="Alex Congritta"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://congritta.com" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Alex Congritta</span></a></div><small class="avatar__subtitle" itemprop="description">React/Node Developer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p><img loading="lazy" src="/assets/images/poster-d847855429228b60240e2b3a42773bab.jpg" width="1440" height="810" class="img_ev3q"></p><p>Наверное многим держателям онлайн-ресурсов знакома проблема, когда сторонние сайты воруют ссылки на скачивание
файлов с вашего сайта, чтобы не хостить их у себя. Или же другие сайты берут прямые ссылки на картинки, библиотеки и
прочую статику с вашего сайта. В любом случае, сервер, на котором расположен ваш сайт, вынужден обрабатывать запросы
с чужих сайтов.</p><p>В этой статье расскажу как порешать эту проблему</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="чем-это-может-быть-плохо">Чем это может быть плохо?<a href="#чем-это-может-быть-плохо" class="hash-link" aria-label="Прямая ссылка на Чем это может быть плохо?" title="Прямая ссылка на Чем это может быть плохо?">​</a></h2><p>Если другие сайты паразитируют на ресурсах вашего сайта, это может привести к тому, что:</p><ol><li>Забьётся выделенный вашему сайту/ресурсу интернет-канал. Не важно, хостинг ли у вас или VPS/VDS, ваш провайдер
ограничивает ваш сайт в скорости и, иногда, в количестве трафика за месяц. Не нужно забывать, что другие сайты
могут быть намного популярнее вашего (с сотнями запросов в секунду и больше). Если такой сайт начнёт к себе
вставлять прямые ссылки на контент из вашего сайта, ваш сайт будет работать медленнее, а за хостинг/сервер
придётся платить больше;</li><li>Возрастёт нагрузка на ресурсы вашего сервера, если сервер обрабатывает статику перед тем, как отдать её
клиентской части вашего приложения (например сжатие картинок или когда ваш сервер делает запрос на сторонний
сервер перед тем, как отдать статику). Опять же, вам придётся раскошелиться на более мощный серввер и на расширенные
квоты сторонних API</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="как-защититься-от-такого">Как защититься от такого<a href="#как-защититься-от-такого" class="hash-link" aria-label="Прямая ссылка на Как защититься от такого" title="Прямая ссылка на Как защититься от такого">​</a></h2><p>То, что описано выше, называется <strong>хотлинкинг</strong>. Если у вашего сайта обычный хостинг (то есть администрирование сервера
лежит на хостинг-провайдере), вам нужно обратиться в поддержку и попросить защитить ваш сайт от хотлинкинга. Это должно
быть бесплатно, хотя провайдер в праве попросить с вас 500-1000 рублей, если это относится к платному
администрированию сервера (зависит от вашего хостинг-провайдера).</p><p>Если вам что-то не получится сделать, как описано в этой статье и у вас собственный сервер/VPS, вы также можете
попросить запросить платное администрирование сервера у вашего провайдера и провайдер поможет осуществить защиту от
хотлинкинга.</p><p><em>А ещё вы можете связаться со мной по контактам в меню сайта и защиту от хотлинкинга сделаю вам я :)</em></p><p>Учтите, что если у вас включена защита от хотлинкинга, то поисковикам будет сложнее индексировать картинки на вашем
сайте и может перестать работать подгрузка обложки сайта (OGP Image). Такое тоже можно порешать, но уже в
индивидуальных случаях.</p><p>Если же у вас VPS, VDS, вам нужно смотреть в настройки HTTP-сервера (Apache, Nginx и т.д.).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="как-это-происходит">Как это происходит<a href="#как-это-происходит" class="hash-link" aria-label="Прямая ссылка на Как это происходит" title="Прямая ссылка на Как это происходит">​</a></h3><p>Когда человек заходит на ваш сайт, браузер, помимо подгрузки страницы, подгружает всю статику (картинки, CSS,
JS-файлы и т.д.). Во время подгрузки статики, браузер отправляет HTTP-заголовок <em>Referer</em>, содержащий адрес сайта, с
которого прилетел запрос к вам на сервер. Вам нужно на стороне сервера смотреть этот заголовок и если сервер
понимает, что запрос прилетел с левого сайта, то отдаём 403 (контент недоступен). Иначе отдаём сам контент.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="вот-как-это-делается-на-nginx">Вот, как это делается на nginx:<a href="#вот-как-это-делается-на-nginx" class="hash-link" aria-label="Прямая ссылка на Вот, как это делается на nginx:" title="Прямая ссылка на Вот, как это делается на nginx:">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location ~ \.(jpe?g|png|gif|js|css)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  valid_referers none blocked congritta.ru *.congritta.ru;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if ($invalid_referer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Это вам нужно впихнуть в .conf-файл, где прописана статика вашего сайта. Глазами можете найти где прописываются
разрешённые домены и вместо моих для примера вы можете вписать свои.</p><p>После смены файла перезагружайте ваш сервер.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="вот-как-это-делается-на-apache-htaccess">Вот, как это делается на Apache (.htaccess):<a href="#вот-как-это-делается-на-apache-htaccess" class="hash-link" aria-label="Прямая ссылка на Вот, как это делается на Apache (.htaccess):" title="Прямая ссылка на Вот, как это делается на Apache (.htaccess):">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RewriteEngine on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RewriteCond %{HTTP_REFERER} !^$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?congritta.ru [NC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?congritta.com [NC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RewriteRule \.(jpg|jpeg|png|gif|css|js)$ - [NC,F,L]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="как-проверить-работает-ли-защита-от-хотлинкинга">Как проверить, работает ли защита от хотлинкинга<a href="#как-проверить-работает-ли-защита-от-хотлинкинга" class="hash-link" aria-label="Прямая ссылка на Как проверить, работает ли защита от хотлинкинга" title="Прямая ссылка на Как проверить, работает ли защита от хотлинкинга">​</a></h3><p>Откройте любую картинку с вашего сайта напрямую в браузере (чтобы полный путь к картинке был в адресной строке).
Если сервер выдал 403, уже хорошо. Если нет - попробуйте скопировать адрес и открыть его же в новой вкладке, должно
выдать 403. Если и так не сработало, значит вы не применили настройки HTTP-сервера или что-то пошло не так. Верните
всё, как было и обратитесь к человеку, который в этом разбирается.</p><p><strong>Убедитесь, что после проведённых манипуляций у вас всё работает!</strong></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Теги:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/информационная-безопасность">информационная безопасность</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/infosec">infosec</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Навигация по странице поста блога"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/i-purchased-winrar"><div class="pagination-nav__sublabel">Следующий пост</div><div class="pagination-nav__label">Я купил WinRAR</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/docker"><div class="pagination-nav__sublabel">Предыдущий пост</div><div class="pagination-nav__label">Поясняю за Docker своими словами</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#чем-это-может-быть-плохо" class="table-of-contents__link toc-highlight">Чем это может быть плохо?</a></li><li><a href="#как-защититься-от-такого" class="table-of-contents__link toc-highlight">Как защититься от такого</a><ul><li><a href="#как-это-происходит" class="table-of-contents__link toc-highlight">Как это происходит</a></li><li><a href="#как-проверить-работает-ли-защита-от-хотлинкинга" class="table-of-contents__link toc-highlight">Как проверить, работает ли защита от хотлинкинга</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Alex Congritta</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6180334c.js"></script>
<script src="/assets/js/main.a9a73014.js"></script>
</body>
</html>